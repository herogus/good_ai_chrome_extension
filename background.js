var background=function(){"use strict";var it=Object.defineProperty;var ot=(Y,j,q)=>j in Y?it(Y,j,{enumerable:!0,configurable:!0,writable:!0,value:q}):Y[j]=q;var ir=(Y,j,q)=>ot(Y,typeof j!="symbol"?j+"":j,q);var rr,tr;function Y(e){return e==null||typeof e=="function"?{main:e}:e}const q={enabled:!1,prefix:{PROJECT_NAME:"Good\u52A9\u624B"}.PROJECT_NAME},S={LOCAL_STORAGE_KEY:"floatingWindowDisabled",PAGE_STORAGE_KEY:"pageFloatingWindowDisabledList",MODEL_INFO_KEY:"modelInfo",MODEL_CONFIGS_KEY:"modelConfigs",THEME_KEY:"appTheme",CHAT_HISTORY_KEY:"chatHistory",USER_INFO_KEY:"userInfo"},B=(e,r)=>({status:"success",message:e,data:r||{}}),E=e=>({status:"failed",message:e});/**
* @vue/shared v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function or(e){const r=Object.create(null);for(const t of e.split(","))r[t]=1;return t=>t in r}const ar=Object.assign,ur=Object.prototype.hasOwnProperty,fe=(e,r)=>ur.call(e,r),z=Array.isArray,ne=e=>Be(e)==="[object Map]",cr=e=>typeof e=="string",Q=e=>typeof e=="symbol",se=e=>e!==null&&typeof e=="object",lr=Object.prototype.toString,Be=e=>lr.call(e),gr=e=>Be(e).slice(8,-1),de=e=>cr(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,X=(e,r)=>!Object.is(e,r);/**
* @vue/reactivity v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let mr,Fe=0,Ae;function he(){Fe++}function pe(){if(--Fe>0)return;let e;for(;Ae;){let r=Ae;for(Ae=void 0;r;){const t=r.next;if(r.next=void 0,r.flags&=-9,r.flags&1)try{r.trigger()}catch(s){e||(e=s)}r=t}}if(e)throw e}let ie=!0;const Ie=[];function fr(){Ie.push(ie),ie=!1}function dr(){const e=Ie.pop();ie=e===void 0?!0:e}class Me{constructor(r){this.computed=r,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(r){}trigger(r){this.version++,this.notify(r)}notify(r){he();try{for(let t=this.subs;t;t=t.prevSub)t.sub.notify()&&t.sub.dep.notify()}finally{pe()}}}const be=new WeakMap,G=Symbol(""),xe=Symbol(""),ee=Symbol("");function T(e,r,t){if(ie&&mr){let s=be.get(e);s||be.set(e,s=new Map);let n=s.get(t);n||(s.set(t,n=new Me),n.map=s,n.key=t),n.track()}}function $(e,r,t,s,n,i){const o=be.get(e);if(!o)return;const a=c=>{c&&c.trigger()};if(he(),r==="clear")o.forEach(a);else{const c=z(e),u=c&&de(t);if(c&&t==="length"){const g=Number(s);o.forEach((f,x)=>{(x==="length"||x===ee||!Q(x)&&x>=g)&&a(f)})}else switch((t!==void 0||o.has(void 0))&&a(o.get(t)),u&&a(o.get(ee)),r){case"add":c?u&&a(o.get("length")):(a(o.get(G)),ne(e)&&a(o.get(xe)));break;case"delete":c||(a(o.get(G)),ne(e)&&a(o.get(xe)));break;case"set":ne(e)&&a(o.get(G));break}}pe()}function H(e){const r=p(e);return r===e?r:(T(r,"iterate",ee),K(e)?r:r.map(C))}function Ee(e){return T(e=p(e),"iterate",ee),e}const Ar={__proto__:null,[Symbol.iterator](){return _e(this,Symbol.iterator,C)},concat(...e){return H(this).concat(...e.map(r=>z(r)?H(r):r))},entries(){return _e(this,"entries",e=>(e[1]=C(e[1]),e))},every(e,r){return M(this,"every",e,r,void 0,arguments)},filter(e,r){return M(this,"filter",e,r,t=>t.map(C),arguments)},find(e,r){return M(this,"find",e,r,C,arguments)},findIndex(e,r){return M(this,"findIndex",e,r,void 0,arguments)},findLast(e,r){return M(this,"findLast",e,r,C,arguments)},findLastIndex(e,r){return M(this,"findLastIndex",e,r,void 0,arguments)},forEach(e,r){return M(this,"forEach",e,r,void 0,arguments)},includes(...e){return we(this,"includes",e)},indexOf(...e){return we(this,"indexOf",e)},join(e){return H(this).join(e)},lastIndexOf(...e){return we(this,"lastIndexOf",e)},map(e,r){return M(this,"map",e,r,void 0,arguments)},pop(){return re(this,"pop")},push(...e){return re(this,"push",e)},reduce(e,...r){return Ne(this,"reduce",e,r)},reduceRight(e,...r){return Ne(this,"reduceRight",e,r)},shift(){return re(this,"shift")},some(e,r){return M(this,"some",e,r,void 0,arguments)},splice(...e){return re(this,"splice",e)},toReversed(){return H(this).toReversed()},toSorted(e){return H(this).toSorted(e)},toSpliced(...e){return H(this).toSpliced(...e)},unshift(...e){return re(this,"unshift",e)},values(){return _e(this,"values",C)}};function _e(e,r,t){const s=Ee(e),n=s[r]();return s!==e&&!K(e)&&(n._next=n.next,n.next=()=>{const i=n._next();return i.value&&(i.value=t(i.value)),i}),n}const hr=Array.prototype;function M(e,r,t,s,n,i){const o=Ee(e),a=o!==e&&!K(e),c=o[r];if(c!==hr[r]){const f=c.apply(e,i);return a?C(f):f}let u=t;o!==e&&(a?u=function(f,x){return t.call(this,C(f),x,e)}:t.length>2&&(u=function(f,x){return t.call(this,f,x,e)}));const g=c.call(o,u,s);return a&&n?n(g):g}function Ne(e,r,t,s){const n=Ee(e);let i=t;return n!==e&&(K(e)?t.length>3&&(i=function(o,a,c){return t.call(this,o,a,c,e)}):i=function(o,a,c){return t.call(this,o,C(a),c,e)}),n[r](i,...s)}function we(e,r,t){const s=p(e);T(s,"iterate",ee);const n=s[r](...t);return(n===-1||n===!1)&&Rr(t[0])?(t[0]=p(t[0]),s[r](...t)):n}function re(e,r,t=[]){fr(),he();const s=p(e)[r].apply(e,t);return pe(),dr(),s}const pr=or("__proto__,__v_isRef,__isVue"),Le=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(Q));function br(e){Q(e)||(e=String(e));const r=p(this);return T(r,"has",e),r.hasOwnProperty(e)}class je{constructor(r=!1,t=!1){this._isReadonly=r,this._isShallow=t}get(r,t,s){if(t==="__v_skip")return r.__v_skip;const n=this._isReadonly,i=this._isShallow;if(t==="__v_isReactive")return!n;if(t==="__v_isReadonly")return n;if(t==="__v_isShallow")return i;if(t==="__v_raw")return s===(n?i?Pr:We:i?Tr:Ke).get(r)||Object.getPrototypeOf(r)===Object.getPrototypeOf(s)?r:void 0;const o=z(r);if(!n){let c;if(o&&(c=Ar[t]))return c;if(t==="hasOwnProperty")return br}const a=Reflect.get(r,t,J(r)?r:s);return(Q(t)?Le.has(t):pr(t))||(n||T(r,"get",t),i)?a:J(a)?o&&de(t)?a:a.value:se(a)?n?Ye(a):ke(a):a}}class xr extends je{constructor(r=!1){super(!1,r)}set(r,t,s,n){let i=r[t];if(!this._isShallow){const c=V(i);if(!K(s)&&!V(s)&&(i=p(i),s=p(s)),!z(r)&&J(i)&&!J(s))return c?!1:(i.value=s,!0)}const o=z(r)&&de(t)?Number(t)<r.length:fe(r,t),a=Reflect.set(r,t,s,J(r)?r:n);return r===p(n)&&(o?X(s,i)&&$(r,"set",t,s):$(r,"add",t,s)),a}deleteProperty(r,t){const s=fe(r,t);r[t];const n=Reflect.deleteProperty(r,t);return n&&s&&$(r,"delete",t,void 0),n}has(r,t){const s=Reflect.has(r,t);return(!Q(t)||!Le.has(t))&&T(r,"has",t),s}ownKeys(r){return T(r,"iterate",z(r)?"length":G),Reflect.ownKeys(r)}}class Er extends je{constructor(r=!1){super(!0,r)}set(r,t){return!0}deleteProperty(r,t){return!0}}const _r=new xr,wr=new Er,ye=e=>e,oe=e=>Reflect.getPrototypeOf(e);function yr(e,r,t){return function(...s){const n=this.__v_raw,i=p(n),o=ne(i),a=e==="entries"||e===Symbol.iterator&&o,c=e==="keys"&&o,u=n[e](...s),g=t?ye:r?ve:C;return!r&&T(i,"iterate",c?xe:G),{next(){const{value:f,done:x}=u.next();return x?{value:f,done:x}:{value:a?[g(f[0]),g(f[1])]:g(f),done:x}},[Symbol.iterator](){return this}}}}function ae(e){return function(...r){return e==="delete"?!1:e==="clear"?void 0:this}}function vr(e,r){const t={get(n){const i=this.__v_raw,o=p(i),a=p(n);e||(X(n,a)&&T(o,"get",n),T(o,"get",a));const{has:c}=oe(o),u=r?ye:e?ve:C;if(c.call(o,n))return u(i.get(n));if(c.call(o,a))return u(i.get(a));i!==o&&i.get(n)},get size(){const n=this.__v_raw;return!e&&T(p(n),"iterate",G),Reflect.get(n,"size",n)},has(n){const i=this.__v_raw,o=p(i),a=p(n);return e||(X(n,a)&&T(o,"has",n),T(o,"has",a)),n===a?i.has(n):i.has(n)||i.has(a)},forEach(n,i){const o=this,a=o.__v_raw,c=p(a),u=r?ye:e?ve:C;return!e&&T(c,"iterate",G),a.forEach((g,f)=>n.call(i,u(g),u(f),o))}};return ar(t,e?{add:ae("add"),set:ae("set"),delete:ae("delete"),clear:ae("clear")}:{add(n){!r&&!K(n)&&!V(n)&&(n=p(n));const i=p(this);return oe(i).has.call(i,n)||(i.add(n),$(i,"add",n,n)),this},set(n,i){!r&&!K(i)&&!V(i)&&(i=p(i));const o=p(this),{has:a,get:c}=oe(o);let u=a.call(o,n);u||(n=p(n),u=a.call(o,n));const g=c.call(o,n);return o.set(n,i),u?X(i,g)&&$(o,"set",n,i):$(o,"add",n,i),this},delete(n){const i=p(this),{has:o,get:a}=oe(i);let c=o.call(i,n);c||(n=p(n),c=o.call(i,n)),a&&a.call(i,n);const u=i.delete(n);return c&&$(i,"delete",n,void 0),u},clear(){const n=p(this),i=n.size!==0,o=n.clear();return i&&$(n,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(n=>{t[n]=yr(n,e,r)}),t}function $e(e,r){const t=vr(e,r);return(s,n,i)=>n==="__v_isReactive"?!e:n==="__v_isReadonly"?e:n==="__v_raw"?s:Reflect.get(fe(t,n)&&n in s?t:s,n,i)}const Sr={get:$e(!1,!1)},Cr={get:$e(!0,!1)},Ke=new WeakMap,Tr=new WeakMap,We=new WeakMap,Pr=new WeakMap;function Or(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Dr(e){return e.__v_skip||!Object.isExtensible(e)?0:Or(gr(e))}function ke(e){return V(e)?e:Ge(e,!1,_r,Sr,Ke)}function Ye(e){return Ge(e,!0,wr,Cr,We)}function Ge(e,r,t,s,n){if(!se(e)||e.__v_raw&&!(r&&e.__v_isReactive))return e;const i=Dr(e);if(i===0)return e;const o=n.get(e);if(o)return o;const a=new Proxy(e,i===2?s:t);return n.set(e,a),a}function V(e){return!!(e&&e.__v_isReadonly)}function K(e){return!!(e&&e.__v_isShallow)}function Rr(e){return e?!!e.__v_raw:!1}function p(e){const r=e&&e.__v_raw;return r?p(r):e}const C=e=>se(e)?ke(e):e,ve=e=>se(e)?Ye(e):e;function J(e){return e?e.__v_isRef===!0:!1}function Br(e){return Fr(e,!1)}function Fr(e,r){return J(e)?e:new Ir(e,r)}class Ir{constructor(r,t){this.dep=new Me,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=t?r:p(r),this._value=t?r:C(r),this.__v_isShallow=t}get value(){return this.dep.track(),this._value}set value(r){const t=this._rawValue,s=this.__v_isShallow||K(r)||V(r);r=s?r:p(r),X(r,t)&&(this._rawValue=r,this._value=s?r:C(r),this.dep.trigger())}}function Ue(e){const r={...q,...e},t=Br(r.enabled),s=(u,...g)=>{if(!t.value)return;const f=r.prefix?`\u3010${r.prefix}\u3011`:"";switch(u){case"log":console.log(`${f}`,...g);break;case"info":console.info(`${f}`,...g);break;case"warn":console.warn(`${f}`,...g);break;case"error":console.error(`${f}`,...g);break}};return{info:(...u)=>s("info",...u),error:(...u)=>s("error",...u),warn:(...u)=>s("warn",...u),logWithPrefix:(...u)=>s("info",...u),enableLogger:u=>{t.value=u}}}const Mr=[EvalError,RangeError,ReferenceError,SyntaxError,TypeError,URIError,globalThis.DOMException,globalThis.AssertionError,globalThis.SystemError].filter(Boolean).map(e=>[e.name,e]),Nr=new Map(Mr);class Se extends Error{constructor(t){super(Se._prepareSuperMessage(t));ir(this,"name","NonError")}static _prepareSuperMessage(t){try{return JSON.stringify(t)}catch{return String(t)}}}const Lr=[{property:"name",enumerable:!1},{property:"message",enumerable:!1},{property:"stack",enumerable:!1},{property:"code",enumerable:!0},{property:"cause",enumerable:!1}],Ce=new WeakSet,jr=e=>{Ce.add(e);const r=e.toJSON();return Ce.delete(e),r},qe=e=>Nr.get(e)??Error,Te=({from:e,seen:r,to:t,forceEnumerable:s,maxDepth:n,depth:i,useToJSON:o,serialize:a})=>{if(!t)if(Array.isArray(e))t=[];else if(!a&&ze(e)){const u=qe(e.name);t=new u}else t={};if(r.push(e),i>=n)return t;if(o&&typeof e.toJSON=="function"&&!Ce.has(e))return jr(e);const c=u=>Te({from:u,seen:[...r],forceEnumerable:s,maxDepth:n,depth:i,useToJSON:o,serialize:a});for(const[u,g]of Object.entries(e)){if(g&&g instanceof Uint8Array&&g.constructor.name==="Buffer"){t[u]="[object Buffer]";continue}if(g!==null&&typeof g=="object"&&typeof g.pipe=="function"){t[u]="[object Stream]";continue}if(typeof g!="function"){if(!g||typeof g!="object"){try{t[u]=g}catch{}continue}if(!r.includes(e[u])){i++,t[u]=c(e[u]);continue}t[u]="[Circular]"}}for(const{property:u,enumerable:g}of Lr)typeof e[u]<"u"&&e[u]!==null&&Object.defineProperty(t,u,{value:ze(e[u])?c(e[u]):e[u],enumerable:s?!0:g,configurable:!0,writable:!0});return t};function $r(e,r={}){const{maxDepth:t=Number.POSITIVE_INFINITY,useToJSON:s=!0}=r;return typeof e=="object"&&e!==null?Te({from:e,seen:[],forceEnumerable:!0,maxDepth:t,depth:0,useToJSON:s,serialize:!0}):typeof e=="function"?`[Function: ${e.name||"anonymous"}]`:e}function Kr(e,r={}){const{maxDepth:t=Number.POSITIVE_INFINITY}=r;if(e instanceof Error)return e;if(Wr(e)){const s=qe(e.name);return Te({from:e,seen:[],to:new s,maxDepth:t,depth:0,serialize:!1})}return new Se(e)}function ze(e){return!!e&&typeof e=="object"&&"name"in e&&"message"in e&&"stack"in e}function Wr(e){return!!e&&typeof e=="object"&&"message"in e&&!Array.isArray(e)}var kr=Object.defineProperty,Yr=Object.defineProperties,Gr=Object.getOwnPropertyDescriptors,He=Object.getOwnPropertySymbols,Ur=Object.prototype.hasOwnProperty,qr=Object.prototype.propertyIsEnumerable,Ve=(e,r,t)=>r in e?kr(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,Je=(e,r)=>{for(var t in r||(r={}))Ur.call(r,t)&&Ve(e,t,r[t]);if(He)for(var t of He(r))qr.call(r,t)&&Ve(e,t,r[t]);return e},Ze=(e,r)=>Yr(e,Gr(r)),zr=(e,r,t)=>new Promise((s,n)=>{var i=c=>{try{a(t.next(c))}catch(u){n(u)}},o=c=>{try{a(t.throw(c))}catch(u){n(u)}},a=c=>c.done?s(c.value):Promise.resolve(c.value).then(i,o);a((t=t.apply(e,r)).next())});function Hr(e){let r,t={};function s(){Object.entries(t).length===0&&(r==null||r(),r=void 0)}let n=Math.floor(Math.random()*1e4);function i(){return n++}return{sendMessage(o,a,...c){return zr(this,null,function*(){var u,g,f,x;const U={id:i(),type:o,data:a,timestamp:Date.now()},F=(g=yield(u=e.verifyMessageData)==null?void 0:u.call(e,U))!=null?g:U;(f=e.logger)==null||f.debug(`[messaging] sendMessage {id=${F.id}} \u2500\u1405`,F,...c);const L=yield e.sendMessage(F,...c),{res:_,err:v}=L??{err:new Error("No response")};if((x=e.logger)==null||x.debug(`[messaging] sendMessage {id=${F.id}} \u140A\u2500`,{res:_,err:v}),v!=null)throw Kr(v);return _})},onMessage(o,a){var c,u,g;if(r==null&&((c=e.logger)==null||c.debug(`[messaging] "${o}" initialized the message listener for this context`),r=e.addRootListener(f=>{var x,U;if(typeof f.type!="string"||typeof f.timestamp!="number"){if(e.breakError)return;const _=Error(`[messaging] Unknown message format, must include the 'type' & 'timestamp' fields, received: ${JSON.stringify(f)}`);throw(x=e.logger)==null||x.error(_),_}(U=e==null?void 0:e.logger)==null||U.debug("[messaging] Received message",f);const F=t[f.type];if(F==null)return;const L=F(f);return Promise.resolve(L).then(_=>{var v,me;return(me=(v=e.verifyMessageData)==null?void 0:v.call(e,_))!=null?me:_}).then(_=>{var v;return(v=e==null?void 0:e.logger)==null||v.debug(`[messaging] onMessage {id=${f.id}} \u2500\u1405`,{res:_}),{res:_}}).catch(_=>{var v;return(v=e==null?void 0:e.logger)==null||v.debug(`[messaging] onMessage {id=${f.id}} \u2500\u1405`,{err:_}),{err:$r(_)}})})),t[o]!=null){const f=Error(`[messaging] In this JS context, only one listener can be setup for ${o}`);throw(u=e.logger)==null||u.error(f),f}return t[o]=a,(g=e.logger)==null||g.log(`[messaging] Added listener for ${o}`),()=>{delete t[o],s()}},removeAllListeners(){Object.keys(t).forEach(o=>{delete t[o]}),s()}}}function Vr(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var ue={exports:{}},Jr=ue.exports,Qe;function Zr(){return Qe||(Qe=1,function(e,r){(function(t,s){s(e)})(typeof globalThis<"u"?globalThis:typeof self<"u"?self:Jr,function(t){var s,n;if(!((n=(s=globalThis.chrome)==null?void 0:s.runtime)!=null&&n.id))throw new Error("This script should only be loaded in a browser extension.");if(typeof globalThis.browser>"u"||Object.getPrototypeOf(globalThis.browser)!==Object.prototype){const i="The message port closed before a response was received.",o=a=>{const c={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(Object.keys(c).length===0)throw new Error("api-metadata.json has not been included in browser-polyfill");class u extends WeakMap{constructor(m,A=void 0){super(A),this.createItem=m}get(m){return this.has(m)||this.set(m,this.createItem(m)),super.get(m)}}const g=l=>l&&typeof l=="object"&&typeof l.then=="function",f=(l,m)=>(...A)=>{a.runtime.lastError?l.reject(new Error(a.runtime.lastError.message)):m.singleCallbackArg||A.length<=1&&m.singleCallbackArg!==!1?l.resolve(A[0]):l.resolve(A)},x=l=>l==1?"argument":"arguments",U=(l,m)=>function(h,...y){if(y.length<m.minArgs)throw new Error(`Expected at least ${m.minArgs} ${x(m.minArgs)} for ${l}(), got ${y.length}`);if(y.length>m.maxArgs)throw new Error(`Expected at most ${m.maxArgs} ${x(m.maxArgs)} for ${l}(), got ${y.length}`);return new Promise((P,D)=>{if(m.fallbackToNoCallback)try{h[l](...y,f({resolve:P,reject:D},m))}catch(d){console.warn(`${l} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,d),h[l](...y),m.fallbackToNoCallback=!1,m.noCallback=!0,P()}else m.noCallback?(h[l](...y),P()):h[l](...y,f({resolve:P,reject:D},m))})},F=(l,m,A)=>new Proxy(m,{apply(h,y,P){return A.call(y,l,...P)}});let L=Function.call.bind(Object.prototype.hasOwnProperty);const _=(l,m={},A={})=>{let h=Object.create(null),y={has(D,d){return d in l||d in h},get(D,d,R){if(d in h)return h[d];if(!(d in l))return;let w=l[d];if(typeof w=="function")if(typeof m[d]=="function")w=F(l,l[d],m[d]);else if(L(A,d)){let Z=U(d,A[d]);w=F(l,l[d],Z)}else w=w.bind(l);else if(typeof w=="object"&&w!==null&&(L(m,d)||L(A,d)))w=_(w,m[d],A[d]);else if(L(A,"*"))w=_(w,m[d],A["*"]);else return Object.defineProperty(h,d,{configurable:!0,enumerable:!0,get(){return l[d]},set(Z){l[d]=Z}}),w;return h[d]=w,w},set(D,d,R,w){return d in h?h[d]=R:l[d]=R,!0},defineProperty(D,d,R){return Reflect.defineProperty(h,d,R)},deleteProperty(D,d){return Reflect.deleteProperty(h,d)}},P=Object.create(l);return new Proxy(P,y)},v=l=>({addListener(m,A,...h){m.addListener(l.get(A),...h)},hasListener(m,A){return m.hasListener(l.get(A))},removeListener(m,A){m.removeListener(l.get(A))}}),me=new u(l=>typeof l!="function"?l:function(A){const h=_(A,{},{getContent:{minArgs:0,maxArgs:0}});l(h)}),nr=new u(l=>typeof l!="function"?l:function(A,h,y){let P=!1,D,d=new Promise(te=>{D=function(I){P=!0,te(I)}}),R;try{R=l(A,h,D)}catch(te){R=Promise.reject(te)}const w=R!==!0&&g(R);if(R!==!0&&!w&&!P)return!1;const Z=te=>{te.then(I=>{y(I)},I=>{let Re;I&&(I instanceof Error||typeof I.message=="string")?Re=I.message:Re="An unexpected error occurred",y({__mozWebExtensionPolyfillReject__:!0,message:Re})}).catch(I=>{console.error("Failed to send onMessage rejected reply",I)})};return Z(w?R:d),!0}),nt=({reject:l,resolve:m},A)=>{a.runtime.lastError?a.runtime.lastError.message===i?m():l(new Error(a.runtime.lastError.message)):A&&A.__mozWebExtensionPolyfillReject__?l(new Error(A.message)):m(A)},sr=(l,m,A,...h)=>{if(h.length<m.minArgs)throw new Error(`Expected at least ${m.minArgs} ${x(m.minArgs)} for ${l}(), got ${h.length}`);if(h.length>m.maxArgs)throw new Error(`Expected at most ${m.maxArgs} ${x(m.maxArgs)} for ${l}(), got ${h.length}`);return new Promise((y,P)=>{const D=nt.bind(null,{resolve:y,reject:P});h.push(D),A.sendMessage(...h)})},st={devtools:{network:{onRequestFinished:v(me)}},runtime:{onMessage:v(nr),onMessageExternal:v(nr),sendMessage:sr.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:sr.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},De={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return c.privacy={network:{"*":De},services:{"*":De},websites:{"*":De}},_(a,st,c)};t.exports=o(chrome)}else t.exports=globalThis.browser})}(ue)),ue.exports}var Qr=Zr();const ce=Vr(Qr);function Xr(e){return Hr(Ze(Je({},e),{sendMessage(r,t){if(t==null)return ce.runtime.sendMessage(r);const s=typeof t=="number"?{tabId:t}:t;return ce.tabs.sendMessage(s.tabId,r,s.frameId!=null?{frameId:s.frameId}:void 0)},addRootListener(r){const t=(s,n)=>r(typeof s=="object"?Ze(Je({},s),{sender:n}):s);return ce.runtime.onMessage.addListener(t),()=>ce.runtime.onMessage.removeListener(t)}}))}const{sendMessage:N,onMessage:O}=Xr(),W=async e=>new Promise((r,t)=>{chrome.storage.local.get([e],s=>{chrome.runtime.lastError?t(new Error(`\u8BFB\u53D6 ${e} \u5931\u8D25: ${chrome.runtime.lastError.message}`)):r(s[e]??null)})}),Pe=async(e,r)=>new Promise((t,s)=>{chrome.storage.local.set({[e]:r},()=>{chrome.runtime.lastError?s(new Error(`\u5199\u5165 ${e} \u5931\u8D25: ${chrome.runtime.lastError.message}`)):t()})}),le=async e=>new Promise((r,t)=>{chrome.storage.local.remove(e,()=>{chrome.runtime.lastError?t(new Error(`\u5220\u9664 ${e} \u5931\u8D25: ${chrome.runtime.lastError.message}`)):r()})}),Xe=Ue(),er=()=>{const e=Date.now().toString(36).slice(-6);let r="";const t="0123456789abcdefghijklmnopqrstuvwxyz";for(let s=0;s<13;s++)r+=t.charAt(Math.floor(Math.random()*t.length));return"user_"+e+r},et=async()=>{try{let e=await W(S.USER_INFO_KEY);return(!e||!e.userId)&&(e={userId:er()},await Pe(S.USER_INFO_KEY,e),Xe.info("\u65B0\u7528\u6237\u5DF2\u521B\u5EFA:",e.userId)),e}catch(e){return Xe.error("\u521D\u59CB\u5316\u7528\u6237\u4FE1\u606F\u5931\u8D25:",e),{userId:er()}}},b=Ue(),k={},rt=Y({persistent:!0,async main(){chrome.runtime.onInstalled.addListener(async()=>{try{const e=await W(S.LOCAL_STORAGE_KEY),r=await W(S.PAGE_STORAGE_KEY)||[];e&&(await le(S.LOCAL_STORAGE_KEY),b.info("\u6E05\u7406\u6B8B\u7559\u7684\u5168\u5C40\u5B58\u50A8\u7981\u7528\u72B6\u6001")),r.length>0&&(await le(S.PAGE_STORAGE_KEY),b.info("\u6E05\u7406\u6B8B\u7559\u7684\u9875\u9762\u5B58\u50A8\u7981\u7528\u72B6\u6001"))}catch(e){b.error("\u6269\u5C55\u521D\u59CB\u5316\u5931\u8D25:",e)}}),O("requestPageContent",async e=>{var r;try{const t=await chrome.tabs.query({active:!0,currentWindow:!0});return(r=t[0])!=null&&r.id?await N("requestPageContent",{config:{maxLength:1e4},forceRefresh:!0},{tabId:t[0].id}):E("NO_ACTIVE_TAB")}catch(t){return b.error("\u8F6C\u53D1\u6D88\u606F\u5931\u8D25:",t),E(String(t))}}),O("findElementContext",async e=>{var r;try{const t=await chrome.tabs.query({active:!0,currentWindow:!0});return(r=t[0])!=null&&r.id?await N("findElementContext",e.data,{tabId:t[0].id}):E("NO_ACTIVE_TAB")}catch(t){return b.error("\u8F6C\u53D1 findElementContext \u5931\u8D25:",t),E(String(t))}}),O("applyStylePatch",async e=>{var r;try{const t=await chrome.tabs.query({active:!0,currentWindow:!0});return(r=t[0])!=null&&r.id?await N("applyStylePatch",e.data,{tabId:t[0].id}):E("NO_ACTIVE_TAB")}catch(t){return b.error("\u8F6C\u53D1 applyStylePatch \u5931\u8D25:",t),E(String(t))}}),O("getPageEditContext",async e=>{var r;try{const t=await chrome.tabs.query({active:!0,currentWindow:!0});return(r=t[0])!=null&&r.id?await N("getPageEditContext",e.data,{tabId:t[0].id}):E("NO_ACTIVE_TAB")}catch(t){return b.error("\u8F6C\u53D1 getPageEditContext \u5931\u8D25:",t),E(String(t))}}),O("applyPagePatch",async e=>{var r;try{const t=await chrome.tabs.query({active:!0,currentWindow:!0});return(r=t[0])!=null&&r.id?await N("applyPagePatch",e.data,{tabId:t[0].id}):E("NO_ACTIVE_TAB")}catch(t){return b.error("\u8F6C\u53D1 applyPagePatch \u5931\u8D25:",t),E(String(t))}}),O("rollbackPagePatch",async e=>{var r;try{const t=await chrome.tabs.query({active:!0,currentWindow:!0});return(r=t[0])!=null&&r.id?await N("rollbackPagePatch",e.data,{tabId:t[0].id}):E("NO_ACTIVE_TAB")}catch(t){return b.error("\u8F6C\u53D1 rollbackPagePatch \u5931\u8D25:",t),E(String(t))}}),O("insertCssForPatch",async e=>{var r,t;try{const{sender:s,data:n}=e,i=(r=s==null?void 0:s.tab)==null?void 0:r.id;if(!i)return E("NO_SENDER_TAB");const{patchId:o,cssText:a}=n;return!o||!a?E("patchId/cssText \u7F3A\u5931"):(await chrome.scripting.insertCSS({target:{tabId:i},css:a}),k[i]||(k[i]={}),(t=k[i])[o]||(t[o]=[]),k[i][o].push(a),B("CSS \u5DF2\u901A\u8FC7 scripting \u6CE8\u5165"))}catch(s){return b.error("insertCssForPatch\u5931\u8D25:",s),E("scripting \u6CE8\u5165\u5931\u8D25: "+((s==null?void 0:s.message)||String(s)))}}),O("removeCssForPatch",async e=>{var r,t;try{const{sender:s,data:n}=e,i=(r=s==null?void 0:s.tab)==null?void 0:r.id;if(!i)return E("NO_SENDER_TAB");const{patchId:o}=n;if(!o)return E("patchId \u7F3A\u5931");const a=((t=k[i])==null?void 0:t[o])||[];for(const c of a)try{await chrome.scripting.removeCSS({target:{tabId:i},css:c})}catch(u){b.warn("removeCSS \u5931\u8D25\uFF08\u5FFD\u7565\u7EE7\u7EED\uFF09:",u)}return k[i]&&delete k[i][o],B("CSS \u56DE\u6EDA\u5B8C\u6210")}catch(s){return b.error("removeCssForPatch\u5931\u8D25:",s),E("scripting \u56DE\u6EDA\u5931\u8D25: "+((s==null?void 0:s.message)||String(s)))}}),O("checkFloatingWindowState",async e=>{var r,t;try{const s=await chrome.tabs.query({active:!0,currentWindow:!0});let n=await W(S.LOCAL_STORAGE_KEY)||!1;const o=(((r=e==null?void 0:e.data)==null?void 0:r.url)||((t=s[0])==null?void 0:t.url)||"").split("?")[0];if(b.info("\u68C0\u67E5\u60AC\u6D6E\u7A97\u72B6\u6001,\u63A5\u6536\u6D88\u606F:",{isDisabled:n,currentUrl:o,pageDisabledArr:await W(S.PAGE_STORAGE_KEY)}),n)return B("\u68C0\u67E5\u7981\u7528\u72B6\u6001\u6210\u529F",{isDisabled:n,localDisabled:n,pageDisabled:!1});if(!n&&o){const c=(await W(S.PAGE_STORAGE_KEY)||[]).includes(o);return n=c,B("\u68C0\u67E5\u7981\u7528\u72B6\u6001\u6210\u529F",{isDisabled:n,localDisabled:!1,pageDisabled:c})}return B("\u68C0\u67E5\u7981\u7528\u72B6\u6001\u6210\u529F",{isDisabled:!1,localDisabled:!1,pageDisabled:!1})}catch(s){return b.error("\u68C0\u67E5\u7981\u7528\u72B6\u6001\u5931\u8D25:",s),B("\u68C0\u67E5\u7981\u7528\u72B6\u6001\u5931\u8D25\uFF0C\u9ED8\u8BA4\u542F\u7528",{isDisabled:!1,localDisabled:!1,pageDisabled:!1})}}),O("setFloatingWindowState",async e=>{var n,i,o;b.info("\u8BBE\u7F6E\u60AC\u6D6E\u7A97\u72B6\u6001,\u63A5\u6536\u6D88\u606F:",e==null?void 0:e.data);const r=e.data.scope,t=e.data.disabled,s=(n=e==null?void 0:e.data)==null?void 0:n.url;try{const a=await chrome.tabs.query({active:!0,currentWindow:!0});if(r=="local")t||(await le(S.LOCAL_STORAGE_KEY),await le(S.PAGE_STORAGE_KEY)),await Pe(S.LOCAL_STORAGE_KEY,t);else{let u=await W(S.PAGE_STORAGE_KEY)||[];const g=(s||((i=a[0])==null?void 0:i.url)||"").split("?")[0];b.info("\u8BBE\u7F6E\u9875\u9762\u7981\u7528,\u5F53\u524D URL:",g,"\u73B0\u6709\u6570\u7EC4:",u),t?(u.length>100&&u.pop(),u.includes(g)||u.unshift(g)):u.includes(g)&&u.splice(u.indexOf(g),1),await Pe(S.PAGE_STORAGE_KEY,u)}let c=(o=a[0])==null?void 0:o.id;try{if(s){const g=(await chrome.tabs.query({})).find(f=>(f.url||"").split("?")[0]===s.split("?")[0]);g!=null&&g.id&&(c=g.id)}}catch{b.warn("\u6839\u636E URL \u5339\u914D\u6807\u7B7E\u9875\u5931\u8D25\uFF0C\u56DE\u9000\u5230\u5F53\u524D\u6FC0\u6D3B\u6807\u7B7E\u9875")}return c&&(t?await N("removeFloatingWindow",{},{tabId:c}):await N("enableFloatingWindow",{},{tabId:c})),B(`\u8BBE\u7F6E${r}\u7981\u7528\u72B6\u6001\u6210\u529F`)}catch(a){return b.error(`\u8BBE\u7F6E${r}\u7981\u7528\u72B6\u6001\u5931\u8D25:`,a),E(String(a))}}),O("getUserInfo",async()=>{try{let e=await W(S.USER_INFO_KEY);return(!e||!e.userId)&&(e=await et()),B("\u83B7\u53D6\u7528\u6237\u4FE1\u606F\u6210\u529F",e)}catch(e){return b.error("\u83B7\u53D6\u7528\u6237\u4FE1\u606F\u5931\u8D25:",e),E(String(e))}}),O("setTheme",async e=>{var t;b.info("\u8BBE\u7F6E\u4E3B\u9898,\u63A5\u6536\u6D88\u606F:",e==null?void 0:e.data);const r=e.data.theme;try{const s=await chrome.tabs.query({active:!0,currentWindow:!0});if(!((t=s[0])!=null&&t.id))return b.warn("\u672A\u627E\u5230\u6D3B\u52A8\u6807\u7B7E\u9875\uFF0C\u4E3B\u9898\u8BBE\u7F6E\u5DF2\u4FDD\u5B58\u5230\u5B58\u50A8"),B(`\u8BBE\u7F6E\u4E3B\u9898\u6210\u529F:${r} (\u672A\u540C\u6B65\u5230\u6807\u7B7E\u9875)`);try{await N("setTheme",{theme:r},{tabId:s[0].id}),b.info("\u4E3B\u9898\u5DF2\u540C\u6B65\u5230\u6807\u7B7E\u9875:",s[0].id)}catch(n){b.warn("\u65E0\u6CD5\u540C\u6B65\u4E3B\u9898\u5230\u6807\u7B7E\u9875 (\u53EF\u80FD\u672A\u6CE8\u5165 content script):",n)}return B(`\u8BBE\u7F6E\u4E3B\u9898\u6210\u529F:${r}`)}catch(s){return b.error("\u8BBE\u7F6E\u4E3B\u9898\u5931\u8D25:",s),E(String(s))}})}});function at(){}(tr=(rr=globalThis.browser)==null?void 0:rr.runtime)!=null&&tr.id?globalThis.browser:globalThis.chrome;function ge(e,...r){}const tt={debug:(...e)=>ge(console.debug,...e),log:(...e)=>ge(console.log,...e),warn:(...e)=>ge(console.warn,...e),error:(...e)=>ge(console.error,...e)};let Oe;try{Oe=rt.main(),Oe instanceof Promise&&console.warn("The background's main() function return a promise, but it must be synchronous")}catch(e){throw tt.error("The background crashed on startup!"),e}return Oe}();
background;
