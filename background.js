var background=function(){"use strict";var et=Object.defineProperty;var rt=(P,C,L)=>C in P?et(P,C,{enumerable:!0,configurable:!0,writable:!0,value:L}):P[C]=L;var Qe=(P,C,L)=>rt(P,typeof C!="symbol"?C+"":C,L);var He,Ve;const P=async e=>new Promise((r,t)=>{chrome.storage.local.get([e],n=>{chrome.runtime.lastError?t(new Error(`读取 ${e} 失败: ${chrome.runtime.lastError.message}`)):r(n[e]??null)})}),C=async(e,r)=>new Promise((t,n)=>{chrome.storage.local.set({[e]:r},()=>{chrome.runtime.lastError?n(new Error(`写入 ${e} 失败: ${chrome.runtime.lastError.message}`)):t()})}),L=async e=>new Promise((r,t)=>{chrome.storage.local.remove(e,()=>{chrome.runtime.lastError?t(new Error(`删除 ${e} 失败: ${chrome.runtime.lastError.message}`)):r()})});function Xe(e){return e==null||typeof e=="function"?{main:e}:e}const er={enabled:!1,prefix:"Good助手"},R={LOCAL_STORAGE_KEY:"floatingWindowDisabled",PAGE_STORAGE_KEY:"pageFloatingWindowDisabledList",MODEL_INFO_KEY:"modelInfo",THEME_KEY:"appTheme"},Q=(e,r)=>({status:"success",message:e,data:r||{}}),k=e=>({status:"failed",message:e});/**
* @vue/shared v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function rr(e){const r=Object.create(null);for(const t of e.split(","))r[t]=1;return t=>t in r}const tr=Object.assign,sr=Object.prototype.hasOwnProperty,ge=(e,r)=>sr.call(e,r),B=Array.isArray,X=e=>Pe(e)==="[object Map]",nr=e=>typeof e=="string",U=e=>typeof e=="symbol",ee=e=>e!==null&&typeof e=="object",ir=Object.prototype.toString,Pe=e=>ir.call(e),or=e=>Pe(e).slice(8,-1),ue=e=>nr(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,H=(e,r)=>!Object.is(e,r);/**
* @vue/reactivity v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let ar,Re=0,me;function fe(){Re++}function Ae(){if(--Re>0)return;let e;for(;me;){let r=me;for(me=void 0;r;){const t=r.next;if(r.next=void 0,r.flags&=-9,r.flags&1)try{r.trigger()}catch(n){e||(e=n)}r=t}}if(e)throw e}let re=!0;const Me=[];function lr(){Me.push(re),re=!1}function cr(){const e=Me.pop();re=e===void 0?!0:e}class Ce{constructor(r){this.computed=r,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(r){}trigger(r){this.version++,this.notify(r)}notify(r){fe();try{for(let t=this.subs;t;t=t.prevSub)t.sub.notify()&&t.sub.dep.notify()}finally{Ae()}}}const de=new WeakMap,D=Symbol(""),he=Symbol(""),V=Symbol("");function v(e,r,t){if(re&&ar){let n=de.get(e);n||de.set(e,n=new Map);let s=n.get(t);s||(n.set(t,s=new Ce),s.map=n,s.key=t),s.track()}}function K(e,r,t,n,s,i){const o=de.get(e);if(!o)return;const a=c=>{c&&c.trigger()};if(fe(),r==="clear")o.forEach(a);else{const c=B(e),l=c&&ue(t);if(c&&t==="length"){const m=Number(n);o.forEach((f,b)=>{(b==="length"||b===V||!U(b)&&b>=m)&&a(f)})}else switch((t!==void 0||o.has(void 0))&&a(o.get(t)),l&&a(o.get(V)),r){case"add":c?l&&a(o.get("length")):(a(o.get(D)),X(e)&&a(o.get(he)));break;case"delete":c||(a(o.get(D)),X(e)&&a(o.get(he)));break;case"set":X(e)&&a(o.get(D));break}}Ae()}function G(e){const r=p(e);return r===e?r:(v(r,"iterate",V),W(e)?r:r.map(E))}function pe(e){return v(e=p(e),"iterate",V),e}const gr={__proto__:null,[Symbol.iterator](){return be(this,Symbol.iterator,E)},concat(...e){return G(this).concat(...e.map(r=>B(r)?G(r):r))},entries(){return be(this,"entries",e=>(e[1]=E(e[1]),e))},every(e,r){return N(this,"every",e,r,void 0,arguments)},filter(e,r){return N(this,"filter",e,r,t=>t.map(E),arguments)},find(e,r){return N(this,"find",e,r,E,arguments)},findIndex(e,r){return N(this,"findIndex",e,r,void 0,arguments)},findLast(e,r){return N(this,"findLast",e,r,E,arguments)},findLastIndex(e,r){return N(this,"findLastIndex",e,r,void 0,arguments)},forEach(e,r){return N(this,"forEach",e,r,void 0,arguments)},includes(...e){return xe(this,"includes",e)},indexOf(...e){return xe(this,"indexOf",e)},join(e){return G(this).join(e)},lastIndexOf(...e){return xe(this,"lastIndexOf",e)},map(e,r){return N(this,"map",e,r,void 0,arguments)},pop(){return J(this,"pop")},push(...e){return J(this,"push",e)},reduce(e,...r){return Ie(this,"reduce",e,r)},reduceRight(e,...r){return Ie(this,"reduceRight",e,r)},shift(){return J(this,"shift")},some(e,r){return N(this,"some",e,r,void 0,arguments)},splice(...e){return J(this,"splice",e)},toReversed(){return G(this).toReversed()},toSorted(e){return G(this).toSorted(e)},toSpliced(...e){return G(this).toSpliced(...e)},unshift(...e){return J(this,"unshift",e)},values(){return be(this,"values",E)}};function be(e,r,t){const n=pe(e),s=n[r]();return n!==e&&!W(e)&&(s._next=s.next,s.next=()=>{const i=s._next();return i.value&&(i.value=t(i.value)),i}),s}const ur=Array.prototype;function N(e,r,t,n,s,i){const o=pe(e),a=o!==e&&!W(e),c=o[r];if(c!==ur[r]){const f=c.apply(e,i);return a?E(f):f}let l=t;o!==e&&(a?l=function(f,b){return t.call(this,E(f),b,e)}:t.length>2&&(l=function(f,b){return t.call(this,f,b,e)}));const m=c.call(o,l,n);return a&&s?s(m):m}function Ie(e,r,t,n){const s=pe(e);let i=t;return s!==e&&(W(e)?t.length>3&&(i=function(o,a,c){return t.call(this,o,a,c,e)}):i=function(o,a,c){return t.call(this,o,E(a),c,e)}),s[r](i,...n)}function xe(e,r,t){const n=p(e);v(n,"iterate",V);const s=n[r](...t);return(s===-1||s===!1)&&Tr(t[0])?(t[0]=p(t[0]),n[r](...t)):s}function J(e,r,t=[]){lr(),fe();const n=p(e)[r].apply(e,t);return Ae(),cr(),n}const mr=rr("__proto__,__v_isRef,__isVue"),je=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(U));function fr(e){U(e)||(e=String(e));const r=p(this);return v(r,"has",e),r.hasOwnProperty(e)}class Le{constructor(r=!1,t=!1){this._isReadonly=r,this._isShallow=t}get(r,t,n){if(t==="__v_skip")return r.__v_skip;const s=this._isReadonly,i=this._isShallow;if(t==="__v_isReactive")return!s;if(t==="__v_isReadonly")return s;if(t==="__v_isShallow")return i;if(t==="__v_raw")return n===(s?i?Er:Ke:i?yr:$e).get(r)||Object.getPrototypeOf(r)===Object.getPrototypeOf(n)?r:void 0;const o=B(r);if(!s){let c;if(o&&(c=gr[t]))return c;if(t==="hasOwnProperty")return fr}const a=Reflect.get(r,t,q(r)?r:n);return(U(t)?je.has(t):mr(t))||(s||v(r,"get",t),i)?a:q(a)?o&&ue(t)?a:a.value:ee(a)?s?De(a):We(a):a}}class Ar extends Le{constructor(r=!1){super(!1,r)}set(r,t,n,s){let i=r[t];if(!this._isShallow){const c=Y(i);if(!W(n)&&!Y(n)&&(i=p(i),n=p(n)),!B(r)&&q(i)&&!q(n))return c?!1:(i.value=n,!0)}const o=B(r)&&ue(t)?Number(t)<r.length:ge(r,t),a=Reflect.set(r,t,n,q(r)?r:s);return r===p(s)&&(o?H(n,i)&&K(r,"set",t,n):K(r,"add",t,n)),a}deleteProperty(r,t){const n=ge(r,t);r[t];const s=Reflect.deleteProperty(r,t);return s&&n&&K(r,"delete",t,void 0),s}has(r,t){const n=Reflect.has(r,t);return(!U(t)||!je.has(t))&&v(r,"has",t),n}ownKeys(r){return v(r,"iterate",B(r)?"length":D),Reflect.ownKeys(r)}}class dr extends Le{constructor(r=!1){super(!0,r)}set(r,t){return!0}deleteProperty(r,t){return!0}}const hr=new Ar,pr=new dr,_e=e=>e,te=e=>Reflect.getPrototypeOf(e);function br(e,r,t){return function(...n){const s=this.__v_raw,i=p(s),o=X(i),a=e==="entries"||e===Symbol.iterator&&o,c=e==="keys"&&o,l=s[e](...n),m=t?_e:r?we:E;return!r&&v(i,"iterate",c?he:D),{next(){const{value:f,done:b}=l.next();return b?{value:f,done:b}:{value:a?[m(f[0]),m(f[1])]:m(f),done:b}},[Symbol.iterator](){return this}}}}function se(e){return function(...r){return e==="delete"?!1:e==="clear"?void 0:this}}function xr(e,r){const t={get(s){const i=this.__v_raw,o=p(i),a=p(s);e||(H(s,a)&&v(o,"get",s),v(o,"get",a));const{has:c}=te(o),l=r?_e:e?we:E;if(c.call(o,s))return l(i.get(s));if(c.call(o,a))return l(i.get(a));i!==o&&i.get(s)},get size(){const s=this.__v_raw;return!e&&v(p(s),"iterate",D),Reflect.get(s,"size",s)},has(s){const i=this.__v_raw,o=p(i),a=p(s);return e||(H(s,a)&&v(o,"has",s),v(o,"has",a)),s===a?i.has(s):i.has(s)||i.has(a)},forEach(s,i){const o=this,a=o.__v_raw,c=p(a),l=r?_e:e?we:E;return!e&&v(c,"iterate",D),a.forEach((m,f)=>s.call(i,l(m),l(f),o))}};return tr(t,e?{add:se("add"),set:se("set"),delete:se("delete"),clear:se("clear")}:{add(s){!r&&!W(s)&&!Y(s)&&(s=p(s));const i=p(this);return te(i).has.call(i,s)||(i.add(s),K(i,"add",s,s)),this},set(s,i){!r&&!W(i)&&!Y(i)&&(i=p(i));const o=p(this),{has:a,get:c}=te(o);let l=a.call(o,s);l||(s=p(s),l=a.call(o,s));const m=c.call(o,s);return o.set(s,i),l?H(i,m)&&K(o,"set",s,i):K(o,"add",s,i),this},delete(s){const i=p(this),{has:o,get:a}=te(i);let c=o.call(i,s);c||(s=p(s),c=o.call(i,s)),a&&a.call(i,s);const l=i.delete(s);return c&&K(i,"delete",s,void 0),l},clear(){const s=p(this),i=s.size!==0,o=s.clear();return i&&K(s,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(s=>{t[s]=br(s,e,r)}),t}function Ne(e,r){const t=xr(e,r);return(n,s,i)=>s==="__v_isReactive"?!e:s==="__v_isReadonly"?e:s==="__v_raw"?n:Reflect.get(ge(t,s)&&s in n?t:n,s,i)}const _r={get:Ne(!1,!1)},wr={get:Ne(!0,!1)},$e=new WeakMap,yr=new WeakMap,Ke=new WeakMap,Er=new WeakMap;function vr(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Sr(e){return e.__v_skip||!Object.isExtensible(e)?0:vr(or(e))}function We(e){return Y(e)?e:Fe(e,!1,hr,_r,$e)}function De(e){return Fe(e,!0,pr,wr,Ke)}function Fe(e,r,t,n,s){if(!ee(e)||e.__v_raw&&!(r&&e.__v_isReactive))return e;const i=Sr(e);if(i===0)return e;const o=s.get(e);if(o)return o;const a=new Proxy(e,i===2?n:t);return s.set(e,a),a}function Y(e){return!!(e&&e.__v_isReadonly)}function W(e){return!!(e&&e.__v_isShallow)}function Tr(e){return e?!!e.__v_raw:!1}function p(e){const r=e&&e.__v_raw;return r?p(r):e}const E=e=>ee(e)?We(e):e,we=e=>ee(e)?De(e):e;function q(e){return e?e.__v_isRef===!0:!1}function Or(e){return Pr(e,!1)}function Pr(e,r){return q(e)?e:new Rr(e,r)}class Rr{constructor(r,t){this.dep=new Ce,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=t?r:p(r),this._value=t?r:E(r),this.__v_isShallow=t}get value(){return this.dep.track(),this._value}set value(r){const t=this._rawValue,n=this.__v_isShallow||W(r)||Y(r);r=n?r:p(r),H(r,t)&&(this._rawValue=r,this._value=n?r:E(r),this.dep.trigger())}}function Mr(e){const r={...er,...e},t=Or(r.enabled),n=(l,...m)=>{if(!t.value)return;const f=r.prefix?`【${r.prefix}】`:"";switch(l){case"log":console.log(`${f}`,...m);break;case"info":console.info(`${f}`,...m);break;case"warn":console.warn(`${f}`,...m);break;case"error":console.error(`${f}`,...m);break}};return{info:(...l)=>n("info",...l),error:(...l)=>n("error",...l),warn:(...l)=>n("warn",...l),logWithPrefix:(...l)=>n("info",...l),enableLogger:l=>{t.value=l}}}const Cr=[EvalError,RangeError,ReferenceError,SyntaxError,TypeError,URIError,globalThis.DOMException,globalThis.AssertionError,globalThis.SystemError].filter(Boolean).map(e=>[e.name,e]),Ir=new Map(Cr);class ye extends Error{constructor(t){super(ye._prepareSuperMessage(t));Qe(this,"name","NonError")}static _prepareSuperMessage(t){try{return JSON.stringify(t)}catch{return String(t)}}}const jr=[{property:"name",enumerable:!1},{property:"message",enumerable:!1},{property:"stack",enumerable:!1},{property:"code",enumerable:!0},{property:"cause",enumerable:!1}],Ee=new WeakSet,Lr=e=>{Ee.add(e);const r=e.toJSON();return Ee.delete(e),r},ke=e=>Ir.get(e)??Error,ve=({from:e,seen:r,to:t,forceEnumerable:n,maxDepth:s,depth:i,useToJSON:o,serialize:a})=>{if(!t)if(Array.isArray(e))t=[];else if(!a&&Be(e)){const l=ke(e.name);t=new l}else t={};if(r.push(e),i>=s)return t;if(o&&typeof e.toJSON=="function"&&!Ee.has(e))return Lr(e);const c=l=>ve({from:l,seen:[...r],forceEnumerable:n,maxDepth:s,depth:i,useToJSON:o,serialize:a});for(const[l,m]of Object.entries(e)){if(m&&m instanceof Uint8Array&&m.constructor.name==="Buffer"){t[l]="[object Buffer]";continue}if(m!==null&&typeof m=="object"&&typeof m.pipe=="function"){t[l]="[object Stream]";continue}if(typeof m!="function"){if(!m||typeof m!="object"){try{t[l]=m}catch{}continue}if(!r.includes(e[l])){i++,t[l]=c(e[l]);continue}t[l]="[Circular]"}}for(const{property:l,enumerable:m}of jr)typeof e[l]<"u"&&e[l]!==null&&Object.defineProperty(t,l,{value:Be(e[l])?c(e[l]):e[l],enumerable:n?!0:m,configurable:!0,writable:!0});return t};function Nr(e,r={}){const{maxDepth:t=Number.POSITIVE_INFINITY,useToJSON:n=!0}=r;return typeof e=="object"&&e!==null?ve({from:e,seen:[],forceEnumerable:!0,maxDepth:t,depth:0,useToJSON:n,serialize:!0}):typeof e=="function"?`[Function: ${e.name||"anonymous"}]`:e}function $r(e,r={}){const{maxDepth:t=Number.POSITIVE_INFINITY}=r;if(e instanceof Error)return e;if(Kr(e)){const n=ke(e.name);return ve({from:e,seen:[],to:new n,maxDepth:t,depth:0,serialize:!1})}return new ye(e)}function Be(e){return!!e&&typeof e=="object"&&"name"in e&&"message"in e&&"stack"in e}function Kr(e){return!!e&&typeof e=="object"&&"message"in e&&!Array.isArray(e)}var Wr=Object.defineProperty,Dr=Object.defineProperties,Fr=Object.getOwnPropertyDescriptors,Ge=Object.getOwnPropertySymbols,kr=Object.prototype.hasOwnProperty,Br=Object.prototype.propertyIsEnumerable,Ye=(e,r,t)=>r in e?Wr(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,qe=(e,r)=>{for(var t in r||(r={}))kr.call(r,t)&&Ye(e,t,r[t]);if(Ge)for(var t of Ge(r))Br.call(r,t)&&Ye(e,t,r[t]);return e},ze=(e,r)=>Dr(e,Fr(r)),Gr=(e,r,t)=>new Promise((n,s)=>{var i=c=>{try{a(t.next(c))}catch(l){s(l)}},o=c=>{try{a(t.throw(c))}catch(l){s(l)}},a=c=>c.done?n(c.value):Promise.resolve(c.value).then(i,o);a((t=t.apply(e,r)).next())});function Yr(e){let r,t={};function n(){Object.entries(t).length===0&&(r==null||r(),r=void 0)}let s=Math.floor(Math.random()*1e4);function i(){return s++}return{sendMessage(o,a,...c){return Gr(this,null,function*(){var l,m,f,b;const F={id:i(),type:o,data:a,timestamp:Date.now()},I=(m=yield(l=e.verifyMessageData)==null?void 0:l.call(e,F))!=null?m:F;(f=e.logger)==null||f.debug(`[messaging] sendMessage {id=${I.id}} ─ᐅ`,I,...c);const $=yield e.sendMessage(I,...c),{res:x,err:y}=$??{err:new Error("No response")};if((b=e.logger)==null||b.debug(`[messaging] sendMessage {id=${I.id}} ᐊ─`,{res:x,err:y}),y!=null)throw $r(y);return x})},onMessage(o,a){var c,l,m;if(r==null&&((c=e.logger)==null||c.debug(`[messaging] "${o}" initialized the message listener for this context`),r=e.addRootListener(f=>{var b,F;if(typeof f.type!="string"||typeof f.timestamp!="number"){if(e.breakError)return;const x=Error(`[messaging] Unknown message format, must include the 'type' & 'timestamp' fields, received: ${JSON.stringify(f)}`);throw(b=e.logger)==null||b.error(x),x}(F=e==null?void 0:e.logger)==null||F.debug("[messaging] Received message",f);const I=t[f.type];if(I==null)return;const $=I(f);return Promise.resolve($).then(x=>{var y,ce;return(ce=(y=e.verifyMessageData)==null?void 0:y.call(e,x))!=null?ce:x}).then(x=>{var y;return(y=e==null?void 0:e.logger)==null||y.debug(`[messaging] onMessage {id=${f.id}} ─ᐅ`,{res:x}),{res:x}}).catch(x=>{var y;return(y=e==null?void 0:e.logger)==null||y.debug(`[messaging] onMessage {id=${f.id}} ─ᐅ`,{err:x}),{err:Nr(x)}})})),t[o]!=null){const f=Error(`[messaging] In this JS context, only one listener can be setup for ${o}`);throw(l=e.logger)==null||l.error(f),f}return t[o]=a,(m=e.logger)==null||m.log(`[messaging] Added listener for ${o}`),()=>{delete t[o],n()}},removeAllListeners(){Object.keys(t).forEach(o=>{delete t[o]}),n()}}}function qr(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var ne={exports:{}},zr=ne.exports,Ue;function Ur(){return Ue||(Ue=1,function(e,r){(function(t,n){n(e)})(typeof globalThis<"u"?globalThis:typeof self<"u"?self:zr,function(t){var n,s;if(!((s=(n=globalThis.chrome)==null?void 0:n.runtime)!=null&&s.id))throw new Error("This script should only be loaded in a browser extension.");if(typeof globalThis.browser>"u"||Object.getPrototypeOf(globalThis.browser)!==Object.prototype){const i="The message port closed before a response was received.",o=a=>{const c={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(Object.keys(c).length===0)throw new Error("api-metadata.json has not been included in browser-polyfill");class l extends WeakMap{constructor(u,d=void 0){super(d),this.createItem=u}get(u){return this.has(u)||this.set(u,this.createItem(u)),super.get(u)}}const m=g=>g&&typeof g=="object"&&typeof g.then=="function",f=(g,u)=>(...d)=>{a.runtime.lastError?g.reject(new Error(a.runtime.lastError.message)):u.singleCallbackArg||d.length<=1&&u.singleCallbackArg!==!1?g.resolve(d[0]):g.resolve(d)},b=g=>g==1?"argument":"arguments",F=(g,u)=>function(h,...w){if(w.length<u.minArgs)throw new Error(`Expected at least ${u.minArgs} ${b(u.minArgs)} for ${g}(), got ${w.length}`);if(w.length>u.maxArgs)throw new Error(`Expected at most ${u.maxArgs} ${b(u.maxArgs)} for ${g}(), got ${w.length}`);return new Promise((S,T)=>{if(u.fallbackToNoCallback)try{h[g](...w,f({resolve:S,reject:T},u))}catch(A){console.warn(`${g} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,A),h[g](...w),u.fallbackToNoCallback=!1,u.noCallback=!0,S()}else u.noCallback?(h[g](...w),S()):h[g](...w,f({resolve:S,reject:T},u))})},I=(g,u,d)=>new Proxy(u,{apply(h,w,S){return d.call(w,g,...S)}});let $=Function.call.bind(Object.prototype.hasOwnProperty);const x=(g,u={},d={})=>{let h=Object.create(null),w={has(T,A){return A in g||A in h},get(T,A,O){if(A in h)return h[A];if(!(A in g))return;let _=g[A];if(typeof _=="function")if(typeof u[A]=="function")_=I(g,g[A],u[A]);else if($(d,A)){let z=F(A,d[A]);_=I(g,g[A],z)}else _=_.bind(g);else if(typeof _=="object"&&_!==null&&($(u,A)||$(d,A)))_=x(_,u[A],d[A]);else if($(d,"*"))_=x(_,u[A],d["*"]);else return Object.defineProperty(h,A,{configurable:!0,enumerable:!0,get(){return g[A]},set(z){g[A]=z}}),_;return h[A]=_,_},set(T,A,O,_){return A in h?h[A]=O:g[A]=O,!0},defineProperty(T,A,O){return Reflect.defineProperty(h,A,O)},deleteProperty(T,A){return Reflect.deleteProperty(h,A)}},S=Object.create(g);return new Proxy(S,w)},y=g=>({addListener(u,d,...h){u.addListener(g.get(d),...h)},hasListener(u,d){return u.hasListener(g.get(d))},removeListener(u,d){u.removeListener(g.get(d))}}),ce=new l(g=>typeof g!="function"?g:function(d){const h=x(d,{},{getContent:{minArgs:0,maxArgs:0}});g(h)}),Je=new l(g=>typeof g!="function"?g:function(d,h,w){let S=!1,T,A=new Promise(Z=>{T=function(j){S=!0,Z(j)}}),O;try{O=g(d,h,T)}catch(Z){O=Promise.reject(Z)}const _=O!==!0&&m(O);if(O!==!0&&!_&&!S)return!1;const z=Z=>{Z.then(j=>{w(j)},j=>{let Oe;j&&(j instanceof Error||typeof j.message=="string")?Oe=j.message:Oe="An unexpected error occurred",w({__mozWebExtensionPolyfillReject__:!0,message:Oe})}).catch(j=>{console.error("Failed to send onMessage rejected reply",j)})};return z(_?O:A),!0}),Qr=({reject:g,resolve:u},d)=>{a.runtime.lastError?a.runtime.lastError.message===i?u():g(new Error(a.runtime.lastError.message)):d&&d.__mozWebExtensionPolyfillReject__?g(new Error(d.message)):u(d)},Ze=(g,u,d,...h)=>{if(h.length<u.minArgs)throw new Error(`Expected at least ${u.minArgs} ${b(u.minArgs)} for ${g}(), got ${h.length}`);if(h.length>u.maxArgs)throw new Error(`Expected at most ${u.maxArgs} ${b(u.maxArgs)} for ${g}(), got ${h.length}`);return new Promise((w,S)=>{const T=Qr.bind(null,{resolve:w,reject:S});h.push(T),d.sendMessage(...h)})},Xr={devtools:{network:{onRequestFinished:y(ce)}},runtime:{onMessage:y(Je),onMessageExternal:y(Je),sendMessage:Ze.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:Ze.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},Te={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return c.privacy={network:{"*":Te},services:{"*":Te},websites:{"*":Te}},x(a,Xr,c)};t.exports=o(chrome)}else t.exports=globalThis.browser})}(ne)),ne.exports}var Hr=Ur();const ie=qr(Hr);function Vr(e){return Yr(ze(qe({},e),{sendMessage(r,t){if(t==null)return ie.runtime.sendMessage(r);const n=typeof t=="number"?{tabId:t}:t;return ie.tabs.sendMessage(n.tabId,r,n.frameId!=null?{frameId:n.frameId}:void 0)},addRootListener(r){const t=(n,s)=>r(typeof n=="object"?ze(qe({},n),{sender:s}):n);return ie.runtime.onMessage.addListener(t),()=>ie.runtime.onMessage.removeListener(t)}}))}const{sendMessage:oe,onMessage:ae}=Vr(),M=Mr(),Jr=Xe({persistent:!0,async main(){chrome.runtime.onInstalled.addListener(async()=>{try{const e=await P(R.LOCAL_STORAGE_KEY),r=await P(R.PAGE_STORAGE_KEY)||[];M.info("扩展启动时存储状态:",{local:e,pageDisabledArr:r}),e&&(await L(R.LOCAL_STORAGE_KEY),M.info("清理残留的全局存储禁用状态")),r.length>0&&(await L(R.PAGE_STORAGE_KEY),M.info("清理残留的页面存储禁用状态"))}catch(e){M.error("初始化存储检查失败:",e)}}),ae("requestPageContent",async e=>{var r;try{const t=await chrome.tabs.query({active:!0,currentWindow:!0});return(r=t[0])!=null&&r.id?await oe("requestPageContent",e,{tabId:t[0].id}):k("NO_ACTIVE_TAB")}catch(t){return M.error("转发消息失败:",t),k(String(t))}}),ae("checkFloatingWindowState",async()=>{var e,r;try{const t=await chrome.tabs.query({active:!0,currentWindow:!0});let n=await P(R.LOCAL_STORAGE_KEY)||!1;if(M.info("检查悬浮窗状态,接收消息:",{isDisabled:n,tabs:t}),n)return Q("检查禁用状态成功",{isDisabled:n,localDisabled:n});if(!n&&((e=t[0])!=null&&e.url))return(await P(R.PAGE_STORAGE_KEY)||[]).includes((r=t[0])==null?void 0:r.url.split("?")[0])&&(n=!0),Q("检查禁用状态成功",{isDisabled:n,localDisabled:!1,pageDisabled:n})}catch(t){return M.error("检查禁用状态失败:",t),k(String(t))}}),ae("setFloatingWindowState",async e=>{var n;M.info("设置悬浮窗状态,接收消息:",e==null?void 0:e.data);const r=e.data.scope,t=e.data.disabled;try{const s=await chrome.tabs.query({active:!0,currentWindow:!0});if(r=="local")t||(await L(R.LOCAL_STORAGE_KEY),await L(R.PAGE_STORAGE_KEY)),await C(R.LOCAL_STORAGE_KEY,t);else{let i=await P(R.PAGE_STORAGE_KEY)||[];const o=(n=s[0])==null?void 0:n.url.split("?")[0];t?(i.length>100&&i.pop(),i.includes(o)||i.unshift(o)):i.includes(o)&&i.splice(i.indexOf(o),1),await C(R.PAGE_STORAGE_KEY,i)}return t?await oe("removeFloatingWindow",{},{tabId:s[0].id}):await oe("enableFloatingWindow",{},{tabId:s[0].id}),Q(`设置${r}禁用状态成功`)}catch(s){return M.error(`设置${r}禁用状态失败:`,s),k(String(s))}}),ae("setTheme",async e=>{var t;M.info("设置主题,接收消息:",e==null?void 0:e.data);const r=e.data.theme;try{const n=await chrome.tabs.query({active:!0,currentWindow:!0});return(t=n[0])!=null&&t.id?(await oe("setTheme",{theme:r},{tabId:n[0].id}),Q(`设置主题成功:${r}`)):k("NO_ACTIVE_TAB")}catch(n){return M.error("设置主题失败:",n),k(String(n))}})}});function st(){}(Ve=(He=globalThis.browser)==null?void 0:He.runtime)!=null&&Ve.id?globalThis.browser:globalThis.chrome;function le(e,...r){}const Zr={debug:(...e)=>le(console.debug,...e),log:(...e)=>le(console.log,...e),warn:(...e)=>le(console.warn,...e),error:(...e)=>le(console.error,...e)};let Se;try{Se=Jr.main(),Se instanceof Promise&&console.warn("The background's main() function return a promise, but it must be synchronous")}catch(e){throw Zr.error("The background crashed on startup!"),e}return Se}();
background;
