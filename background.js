var background=function(){"use strict";var nt=Object.defineProperty;var it=($,M,k)=>M in $?nt($,M,{enumerable:!0,configurable:!0,writable:!0,value:k}):$[M]=k;var nr=($,M,k)=>it($,typeof M!="symbol"?M+"":M,k);var er,rr;function $(e){return e==null||typeof e=="function"?{main:e}:e}const k={enabled:!1,prefix:"Good\u52A9\u624B"},v={LOCAL_STORAGE_KEY:"floatingWindowDisabled",PAGE_STORAGE_KEY:"pageFloatingWindowDisabledList",MODEL_INFO_KEY:"modelInfo",MODEL_CONFIGS_KEY:"modelConfigs",THEME_KEY:"appTheme",CHAT_HISTORY_KEY:"chatHistory",USER_INFO_KEY:"userInfo"},I=(e,r)=>({status:"success",message:e,data:r||{}}),H=e=>({status:"failed",message:e});/**
* @vue/shared v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function ir(e){const r=Object.create(null);for(const t of e.split(","))r[t]=1;return t=>t in r}const or=Object.assign,ar=Object.prototype.hasOwnProperty,me=(e,r)=>ar.call(e,r),Y=Array.isArray,re=e=>Ce(e)==="[object Map]",ur=e=>typeof e=="string",J=e=>typeof e=="symbol",te=e=>e!==null&&typeof e=="object",lr=Object.prototype.toString,Ce=e=>lr.call(e),cr=e=>Ce(e).slice(8,-1),fe=e=>ur(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,V=(e,r)=>!Object.is(e,r);/**
* @vue/reactivity v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let gr,De=0,Ae;function de(){De++}function he(){if(--De>0)return;let e;for(;Ae;){let r=Ae;for(Ae=void 0;r;){const t=r.next;if(r.next=void 0,r.flags&=-9,r.flags&1)try{r.trigger()}catch(n){e||(e=n)}r=t}}if(e)throw e}let se=!0;const Fe=[];function mr(){Fe.push(se),se=!1}function fr(){const e=Fe.pop();se=e===void 0?!0:e}class Me{constructor(r){this.computed=r,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(r){}trigger(r){this.version++,this.notify(r)}notify(r){de();try{for(let t=this.subs;t;t=t.prevSub)t.sub.notify()&&t.sub.dep.notify()}finally{he()}}}const pe=new WeakMap,K=Symbol(""),be=Symbol(""),Z=Symbol("");function T(e,r,t){if(se&&gr){let n=pe.get(e);n||pe.set(e,n=new Map);let s=n.get(t);s||(n.set(t,s=new Me),s.map=n,s.key=t),s.track()}}function j(e,r,t,n,s,o){const i=pe.get(e);if(!i)return;const a=l=>{l&&l.trigger()};if(de(),r==="clear")i.forEach(a);else{const l=Y(e),u=l&&fe(t);if(l&&t==="length"){const g=Number(n);i.forEach((f,b)=>{(b==="length"||b===Z||!J(b)&&b>=g)&&a(f)})}else switch((t!==void 0||i.has(void 0))&&a(i.get(t)),u&&a(i.get(Z)),r){case"add":l?u&&a(i.get("length")):(a(i.get(K)),re(e)&&a(i.get(be)));break;case"delete":l||(a(i.get(K)),re(e)&&a(i.get(be)));break;case"set":re(e)&&a(i.get(K));break}}he()}function G(e){const r=p(e);return r===e?r:(T(r,"iterate",Z),L(e)?r:r.map(S))}function xe(e){return T(e=p(e),"iterate",Z),e}const Ar={__proto__:null,[Symbol.iterator](){return _e(this,Symbol.iterator,S)},concat(...e){return G(this).concat(...e.map(r=>Y(r)?G(r):r))},entries(){return _e(this,"entries",e=>(e[1]=S(e[1]),e))},every(e,r){return D(this,"every",e,r,void 0,arguments)},filter(e,r){return D(this,"filter",e,r,t=>t.map(S),arguments)},find(e,r){return D(this,"find",e,r,S,arguments)},findIndex(e,r){return D(this,"findIndex",e,r,void 0,arguments)},findLast(e,r){return D(this,"findLast",e,r,S,arguments)},findLastIndex(e,r){return D(this,"findLastIndex",e,r,void 0,arguments)},forEach(e,r){return D(this,"forEach",e,r,void 0,arguments)},includes(...e){return Ee(this,"includes",e)},indexOf(...e){return Ee(this,"indexOf",e)},join(e){return G(this).join(e)},lastIndexOf(...e){return Ee(this,"lastIndexOf",e)},map(e,r){return D(this,"map",e,r,void 0,arguments)},pop(){return Q(this,"pop")},push(...e){return Q(this,"push",e)},reduce(e,...r){return Ie(this,"reduce",e,r)},reduceRight(e,...r){return Ie(this,"reduceRight",e,r)},shift(){return Q(this,"shift")},some(e,r){return D(this,"some",e,r,void 0,arguments)},splice(...e){return Q(this,"splice",e)},toReversed(){return G(this).toReversed()},toSorted(e){return G(this).toSorted(e)},toSpliced(...e){return G(this).toSpliced(...e)},unshift(...e){return Q(this,"unshift",e)},values(){return _e(this,"values",S)}};function _e(e,r,t){const n=xe(e),s=n[r]();return n!==e&&!L(e)&&(s._next=s.next,s.next=()=>{const o=s._next();return o.value&&(o.value=t(o.value)),o}),s}const dr=Array.prototype;function D(e,r,t,n,s,o){const i=xe(e),a=i!==e&&!L(e),l=i[r];if(l!==dr[r]){const f=l.apply(e,o);return a?S(f):f}let u=t;i!==e&&(a?u=function(f,b){return t.call(this,S(f),b,e)}:t.length>2&&(u=function(f,b){return t.call(this,f,b,e)}));const g=l.call(i,u,n);return a&&s?s(g):g}function Ie(e,r,t,n){const s=xe(e);let o=t;return s!==e&&(L(e)?t.length>3&&(o=function(i,a,l){return t.call(this,i,a,l,e)}):o=function(i,a,l){return t.call(this,i,S(a),l,e)}),s[r](o,...n)}function Ee(e,r,t){const n=p(e);T(n,"iterate",Z);const s=n[r](...t);return(s===-1||s===!1)&&Pr(t[0])?(t[0]=p(t[0]),n[r](...t)):s}function Q(e,r,t=[]){mr(),de();const n=p(e)[r].apply(e,t);return he(),fr(),n}const hr=ir("__proto__,__v_isRef,__isVue"),je=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(J));function pr(e){J(e)||(e=String(e));const r=p(this);return T(r,"has",e),r.hasOwnProperty(e)}class Le{constructor(r=!1,t=!1){this._isReadonly=r,this._isShallow=t}get(r,t,n){if(t==="__v_skip")return r.__v_skip;const s=this._isReadonly,o=this._isShallow;if(t==="__v_isReactive")return!s;if(t==="__v_isReadonly")return s;if(t==="__v_isShallow")return o;if(t==="__v_raw")return n===(s?o?Or:Ke:o?Tr:$e).get(r)||Object.getPrototypeOf(r)===Object.getPrototypeOf(n)?r:void 0;const i=Y(r);if(!s){let l;if(i&&(l=Ar[t]))return l;if(t==="hasOwnProperty")return pr}const a=Reflect.get(r,t,q(r)?r:n);return(J(t)?je.has(t):hr(t))||(s||T(r,"get",t),o)?a:q(a)?i&&fe(t)?a:a.value:te(a)?s?ke(a):We(a):a}}class br extends Le{constructor(r=!1){super(!1,r)}set(r,t,n,s){let o=r[t];if(!this._isShallow){const l=U(o);if(!L(n)&&!U(n)&&(o=p(o),n=p(n)),!Y(r)&&q(o)&&!q(n))return l?!1:(o.value=n,!0)}const i=Y(r)&&fe(t)?Number(t)<r.length:me(r,t),a=Reflect.set(r,t,n,q(r)?r:s);return r===p(s)&&(i?V(n,o)&&j(r,"set",t,n):j(r,"add",t,n)),a}deleteProperty(r,t){const n=me(r,t);r[t];const s=Reflect.deleteProperty(r,t);return s&&n&&j(r,"delete",t,void 0),s}has(r,t){const n=Reflect.has(r,t);return(!J(t)||!je.has(t))&&T(r,"has",t),n}ownKeys(r){return T(r,"iterate",Y(r)?"length":K),Reflect.ownKeys(r)}}class xr extends Le{constructor(r=!1){super(!0,r)}set(r,t){return!0}deleteProperty(r,t){return!0}}const _r=new br,Er=new xr,we=e=>e,ne=e=>Reflect.getPrototypeOf(e);function wr(e,r,t){return function(...n){const s=this.__v_raw,o=p(s),i=re(o),a=e==="entries"||e===Symbol.iterator&&i,l=e==="keys"&&i,u=s[e](...n),g=t?we:r?ye:S;return!r&&T(o,"iterate",l?be:K),{next(){const{value:f,done:b}=u.next();return b?{value:f,done:b}:{value:a?[g(f[0]),g(f[1])]:g(f),done:b}},[Symbol.iterator](){return this}}}}function ie(e){return function(...r){return e==="delete"?!1:e==="clear"?void 0:this}}function yr(e,r){const t={get(s){const o=this.__v_raw,i=p(o),a=p(s);e||(V(s,a)&&T(i,"get",s),T(i,"get",a));const{has:l}=ne(i),u=r?we:e?ye:S;if(l.call(i,s))return u(o.get(s));if(l.call(i,a))return u(o.get(a));o!==i&&o.get(s)},get size(){const s=this.__v_raw;return!e&&T(p(s),"iterate",K),Reflect.get(s,"size",s)},has(s){const o=this.__v_raw,i=p(o),a=p(s);return e||(V(s,a)&&T(i,"has",s),T(i,"has",a)),s===a?o.has(s):o.has(s)||o.has(a)},forEach(s,o){const i=this,a=i.__v_raw,l=p(a),u=r?we:e?ye:S;return!e&&T(l,"iterate",K),a.forEach((g,f)=>s.call(o,u(g),u(f),i))}};return or(t,e?{add:ie("add"),set:ie("set"),delete:ie("delete"),clear:ie("clear")}:{add(s){!r&&!L(s)&&!U(s)&&(s=p(s));const o=p(this);return ne(o).has.call(o,s)||(o.add(s),j(o,"add",s,s)),this},set(s,o){!r&&!L(o)&&!U(o)&&(o=p(o));const i=p(this),{has:a,get:l}=ne(i);let u=a.call(i,s);u||(s=p(s),u=a.call(i,s));const g=l.call(i,s);return i.set(s,o),u?V(o,g)&&j(i,"set",s,o):j(i,"add",s,o),this},delete(s){const o=p(this),{has:i,get:a}=ne(o);let l=i.call(o,s);l||(s=p(s),l=i.call(o,s)),a&&a.call(o,s);const u=o.delete(s);return l&&j(o,"delete",s,void 0),u},clear(){const s=p(this),o=s.size!==0,i=s.clear();return o&&j(s,"clear",void 0,void 0),i}}),["keys","values","entries",Symbol.iterator].forEach(s=>{t[s]=wr(s,e,r)}),t}function Ne(e,r){const t=yr(e,r);return(n,s,o)=>s==="__v_isReactive"?!e:s==="__v_isReadonly"?e:s==="__v_raw"?n:Reflect.get(me(t,s)&&s in n?t:n,s,o)}const vr={get:Ne(!1,!1)},Sr={get:Ne(!0,!1)},$e=new WeakMap,Tr=new WeakMap,Ke=new WeakMap,Or=new WeakMap;function Rr(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Br(e){return e.__v_skip||!Object.isExtensible(e)?0:Rr(cr(e))}function We(e){return U(e)?e:Ye(e,!1,_r,vr,$e)}function ke(e){return Ye(e,!0,Er,Sr,Ke)}function Ye(e,r,t,n,s){if(!te(e)||e.__v_raw&&!(r&&e.__v_isReactive))return e;const o=Br(e);if(o===0)return e;const i=s.get(e);if(i)return i;const a=new Proxy(e,o===2?n:t);return s.set(e,a),a}function U(e){return!!(e&&e.__v_isReadonly)}function L(e){return!!(e&&e.__v_isShallow)}function Pr(e){return e?!!e.__v_raw:!1}function p(e){const r=e&&e.__v_raw;return r?p(r):e}const S=e=>te(e)?We(e):e,ye=e=>te(e)?ke(e):e;function q(e){return e?e.__v_isRef===!0:!1}function Cr(e){return Dr(e,!1)}function Dr(e,r){return q(e)?e:new Fr(e,r)}class Fr{constructor(r,t){this.dep=new Me,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=t?r:p(r),this._value=t?r:S(r),this.__v_isShallow=t}get value(){return this.dep.track(),this._value}set value(r){const t=this._rawValue,n=this.__v_isShallow||L(r)||U(r);r=n?r:p(r),V(r,t)&&(this._rawValue=r,this._value=n?r:S(r),this.dep.trigger())}}function Ge(e){const r={...k,...e},t=Cr(r.enabled),n=(u,...g)=>{if(!t.value)return;const f=r.prefix?`\u3010${r.prefix}\u3011`:"";switch(u){case"log":console.log(`${f}`,...g);break;case"info":console.info(`${f}`,...g);break;case"warn":console.warn(`${f}`,...g);break;case"error":console.error(`${f}`,...g);break}};return{info:(...u)=>n("info",...u),error:(...u)=>n("error",...u),warn:(...u)=>n("warn",...u),logWithPrefix:(...u)=>n("info",...u),enableLogger:u=>{t.value=u}}}const Mr=[EvalError,RangeError,ReferenceError,SyntaxError,TypeError,URIError,globalThis.DOMException,globalThis.AssertionError,globalThis.SystemError].filter(Boolean).map(e=>[e.name,e]),Ir=new Map(Mr);class ve extends Error{constructor(t){super(ve._prepareSuperMessage(t));nr(this,"name","NonError")}static _prepareSuperMessage(t){try{return JSON.stringify(t)}catch{return String(t)}}}const jr=[{property:"name",enumerable:!1},{property:"message",enumerable:!1},{property:"stack",enumerable:!1},{property:"code",enumerable:!0},{property:"cause",enumerable:!1}],Se=new WeakSet,Lr=e=>{Se.add(e);const r=e.toJSON();return Se.delete(e),r},Ue=e=>Ir.get(e)??Error,Te=({from:e,seen:r,to:t,forceEnumerable:n,maxDepth:s,depth:o,useToJSON:i,serialize:a})=>{if(!t)if(Array.isArray(e))t=[];else if(!a&&qe(e)){const u=Ue(e.name);t=new u}else t={};if(r.push(e),o>=s)return t;if(i&&typeof e.toJSON=="function"&&!Se.has(e))return Lr(e);const l=u=>Te({from:u,seen:[...r],forceEnumerable:n,maxDepth:s,depth:o,useToJSON:i,serialize:a});for(const[u,g]of Object.entries(e)){if(g&&g instanceof Uint8Array&&g.constructor.name==="Buffer"){t[u]="[object Buffer]";continue}if(g!==null&&typeof g=="object"&&typeof g.pipe=="function"){t[u]="[object Stream]";continue}if(typeof g!="function"){if(!g||typeof g!="object"){try{t[u]=g}catch{}continue}if(!r.includes(e[u])){o++,t[u]=l(e[u]);continue}t[u]="[Circular]"}}for(const{property:u,enumerable:g}of jr)typeof e[u]<"u"&&e[u]!==null&&Object.defineProperty(t,u,{value:qe(e[u])?l(e[u]):e[u],enumerable:n?!0:g,configurable:!0,writable:!0});return t};function Nr(e,r={}){const{maxDepth:t=Number.POSITIVE_INFINITY,useToJSON:n=!0}=r;return typeof e=="object"&&e!==null?Te({from:e,seen:[],forceEnumerable:!0,maxDepth:t,depth:0,useToJSON:n,serialize:!0}):typeof e=="function"?`[Function: ${e.name||"anonymous"}]`:e}function $r(e,r={}){const{maxDepth:t=Number.POSITIVE_INFINITY}=r;if(e instanceof Error)return e;if(Kr(e)){const n=Ue(e.name);return Te({from:e,seen:[],to:new n,maxDepth:t,depth:0,serialize:!1})}return new ve(e)}function qe(e){return!!e&&typeof e=="object"&&"name"in e&&"message"in e&&"stack"in e}function Kr(e){return!!e&&typeof e=="object"&&"message"in e&&!Array.isArray(e)}var Wr=Object.defineProperty,kr=Object.defineProperties,Yr=Object.getOwnPropertyDescriptors,ze=Object.getOwnPropertySymbols,Gr=Object.prototype.hasOwnProperty,Ur=Object.prototype.propertyIsEnumerable,He=(e,r,t)=>r in e?Wr(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,Je=(e,r)=>{for(var t in r||(r={}))Gr.call(r,t)&&He(e,t,r[t]);if(ze)for(var t of ze(r))Ur.call(r,t)&&He(e,t,r[t]);return e},Ve=(e,r)=>kr(e,Yr(r)),qr=(e,r,t)=>new Promise((n,s)=>{var o=l=>{try{a(t.next(l))}catch(u){s(u)}},i=l=>{try{a(t.throw(l))}catch(u){s(u)}},a=l=>l.done?n(l.value):Promise.resolve(l.value).then(o,i);a((t=t.apply(e,r)).next())});function zr(e){let r,t={};function n(){Object.entries(t).length===0&&(r==null||r(),r=void 0)}let s=Math.floor(Math.random()*1e4);function o(){return s++}return{sendMessage(i,a,...l){return qr(this,null,function*(){var u,g,f,b;const W={id:o(),type:i,data:a,timestamp:Date.now()},P=(g=yield(u=e.verifyMessageData)==null?void 0:u.call(e,W))!=null?g:W;(f=e.logger)==null||f.debug(`[messaging] sendMessage {id=${P.id}} \u2500\u1405`,P,...l);const F=yield e.sendMessage(P,...l),{res:x,err:y}=F??{err:new Error("No response")};if((b=e.logger)==null||b.debug(`[messaging] sendMessage {id=${P.id}} \u140A\u2500`,{res:x,err:y}),y!=null)throw $r(y);return x})},onMessage(i,a){var l,u,g;if(r==null&&((l=e.logger)==null||l.debug(`[messaging] "${i}" initialized the message listener for this context`),r=e.addRootListener(f=>{var b,W;if(typeof f.type!="string"||typeof f.timestamp!="number"){if(e.breakError)return;const x=Error(`[messaging] Unknown message format, must include the 'type' & 'timestamp' fields, received: ${JSON.stringify(f)}`);throw(b=e.logger)==null||b.error(x),x}(W=e==null?void 0:e.logger)==null||W.debug("[messaging] Received message",f);const P=t[f.type];if(P==null)return;const F=P(f);return Promise.resolve(F).then(x=>{var y,ge;return(ge=(y=e.verifyMessageData)==null?void 0:y.call(e,x))!=null?ge:x}).then(x=>{var y;return(y=e==null?void 0:e.logger)==null||y.debug(`[messaging] onMessage {id=${f.id}} \u2500\u1405`,{res:x}),{res:x}}).catch(x=>{var y;return(y=e==null?void 0:e.logger)==null||y.debug(`[messaging] onMessage {id=${f.id}} \u2500\u1405`,{err:x}),{err:Nr(x)}})})),t[i]!=null){const f=Error(`[messaging] In this JS context, only one listener can be setup for ${i}`);throw(u=e.logger)==null||u.error(f),f}return t[i]=a,(g=e.logger)==null||g.log(`[messaging] Added listener for ${i}`),()=>{delete t[i],n()}},removeAllListeners(){Object.keys(t).forEach(i=>{delete t[i]}),n()}}}function Hr(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var oe={exports:{}},Jr=oe.exports,Ze;function Vr(){return Ze||(Ze=1,function(e,r){(function(t,n){n(e)})(typeof globalThis<"u"?globalThis:typeof self<"u"?self:Jr,function(t){var n,s;if(!((s=(n=globalThis.chrome)==null?void 0:n.runtime)!=null&&s.id))throw new Error("This script should only be loaded in a browser extension.");if(typeof globalThis.browser>"u"||Object.getPrototypeOf(globalThis.browser)!==Object.prototype){const o="The message port closed before a response was received.",i=a=>{const l={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(Object.keys(l).length===0)throw new Error("api-metadata.json has not been included in browser-polyfill");class u extends WeakMap{constructor(m,d=void 0){super(d),this.createItem=m}get(m){return this.has(m)||this.set(m,this.createItem(m)),super.get(m)}}const g=c=>c&&typeof c=="object"&&typeof c.then=="function",f=(c,m)=>(...d)=>{a.runtime.lastError?c.reject(new Error(a.runtime.lastError.message)):m.singleCallbackArg||d.length<=1&&m.singleCallbackArg!==!1?c.resolve(d[0]):c.resolve(d)},b=c=>c==1?"argument":"arguments",W=(c,m)=>function(h,...E){if(E.length<m.minArgs)throw new Error(`Expected at least ${m.minArgs} ${b(m.minArgs)} for ${c}(), got ${E.length}`);if(E.length>m.maxArgs)throw new Error(`Expected at most ${m.maxArgs} ${b(m.maxArgs)} for ${c}(), got ${E.length}`);return new Promise((O,R)=>{if(m.fallbackToNoCallback)try{h[c](...E,f({resolve:O,reject:R},m))}catch(A){console.warn(`${c} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,A),h[c](...E),m.fallbackToNoCallback=!1,m.noCallback=!0,O()}else m.noCallback?(h[c](...E),O()):h[c](...E,f({resolve:O,reject:R},m))})},P=(c,m,d)=>new Proxy(m,{apply(h,E,O){return d.call(E,c,...O)}});let F=Function.call.bind(Object.prototype.hasOwnProperty);const x=(c,m={},d={})=>{let h=Object.create(null),E={has(R,A){return A in c||A in h},get(R,A,B){if(A in h)return h[A];if(!(A in c))return;let _=c[A];if(typeof _=="function")if(typeof m[A]=="function")_=P(c,c[A],m[A]);else if(F(d,A)){let z=W(A,d[A]);_=P(c,c[A],z)}else _=_.bind(c);else if(typeof _=="object"&&_!==null&&(F(m,A)||F(d,A)))_=x(_,m[A],d[A]);else if(F(d,"*"))_=x(_,m[A],d["*"]);else return Object.defineProperty(h,A,{configurable:!0,enumerable:!0,get(){return c[A]},set(z){c[A]=z}}),_;return h[A]=_,_},set(R,A,B,_){return A in h?h[A]=B:c[A]=B,!0},defineProperty(R,A,B){return Reflect.defineProperty(h,A,B)},deleteProperty(R,A){return Reflect.deleteProperty(h,A)}},O=Object.create(c);return new Proxy(O,E)},y=c=>({addListener(m,d,...h){m.addListener(c.get(d),...h)},hasListener(m,d){return m.hasListener(c.get(d))},removeListener(m,d){m.removeListener(c.get(d))}}),ge=new u(c=>typeof c!="function"?c:function(d){const h=x(d,{},{getContent:{minArgs:0,maxArgs:0}});c(h)}),tr=new u(c=>typeof c!="function"?c:function(d,h,E){let O=!1,R,A=new Promise(ee=>{R=function(C){O=!0,ee(C)}}),B;try{B=c(d,h,R)}catch(ee){B=Promise.reject(ee)}const _=B!==!0&&g(B);if(B!==!0&&!_&&!O)return!1;const z=ee=>{ee.then(C=>{E(C)},C=>{let Pe;C&&(C instanceof Error||typeof C.message=="string")?Pe=C.message:Pe="An unexpected error occurred",E({__mozWebExtensionPolyfillReject__:!0,message:Pe})}).catch(C=>{console.error("Failed to send onMessage rejected reply",C)})};return z(_?B:A),!0}),tt=({reject:c,resolve:m},d)=>{a.runtime.lastError?a.runtime.lastError.message===o?m():c(new Error(a.runtime.lastError.message)):d&&d.__mozWebExtensionPolyfillReject__?c(new Error(d.message)):m(d)},sr=(c,m,d,...h)=>{if(h.length<m.minArgs)throw new Error(`Expected at least ${m.minArgs} ${b(m.minArgs)} for ${c}(), got ${h.length}`);if(h.length>m.maxArgs)throw new Error(`Expected at most ${m.maxArgs} ${b(m.maxArgs)} for ${c}(), got ${h.length}`);return new Promise((E,O)=>{const R=tt.bind(null,{resolve:E,reject:O});h.push(R),d.sendMessage(...h)})},st={devtools:{network:{onRequestFinished:y(ge)}},runtime:{onMessage:y(tr),onMessageExternal:y(tr),sendMessage:sr.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:sr.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},Be={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return l.privacy={network:{"*":Be},services:{"*":Be},websites:{"*":Be}},x(a,st,l)};t.exports=i(chrome)}else t.exports=globalThis.browser})}(oe)),oe.exports}var Zr=Vr();const ae=Hr(Zr);function Qr(e){return zr(Ve(Je({},e),{sendMessage(r,t){if(t==null)return ae.runtime.sendMessage(r);const n=typeof t=="number"?{tabId:t}:t;return ae.tabs.sendMessage(n.tabId,r,n.frameId!=null?{frameId:n.frameId}:void 0)},addRootListener(r){const t=(n,s)=>r(typeof n=="object"?Ve(Je({},n),{sender:s}):n);return ae.runtime.onMessage.addListener(t),()=>ae.runtime.onMessage.removeListener(t)}}))}const{sendMessage:ue,onMessage:X}=Qr(),N=async e=>new Promise((r,t)=>{chrome.storage.local.get([e],n=>{chrome.runtime.lastError?t(new Error(`\u8BFB\u53D6 ${e} \u5931\u8D25: ${chrome.runtime.lastError.message}`)):r(n[e]??null)})}),Oe=async(e,r)=>new Promise((t,n)=>{chrome.storage.local.set({[e]:r},()=>{chrome.runtime.lastError?n(new Error(`\u5199\u5165 ${e} \u5931\u8D25: ${chrome.runtime.lastError.message}`)):t()})}),le=async e=>new Promise((r,t)=>{chrome.storage.local.remove(e,()=>{chrome.runtime.lastError?t(new Error(`\u5220\u9664 ${e} \u5931\u8D25: ${chrome.runtime.lastError.message}`)):r()})}),Qe=Ge(),Xe=()=>{const e=Date.now().toString(36).slice(-6);let r="";const t="0123456789abcdefghijklmnopqrstuvwxyz";for(let n=0;n<13;n++)r+=t.charAt(Math.floor(Math.random()*t.length));return"user_"+e+r},Xr=async()=>{try{let e=await N(v.USER_INFO_KEY);return(!e||!e.userId)&&(e={userId:Xe()},await Oe(v.USER_INFO_KEY,e),Qe.info("\u65B0\u7528\u6237\u5DF2\u521B\u5EFA:",e.userId)),e}catch(e){return Qe.error("\u521D\u59CB\u5316\u7528\u6237\u4FE1\u606F\u5931\u8D25:",e),{userId:Xe()}}},w=Ge(),et=$({persistent:!0,async main(){chrome.runtime.onInstalled.addListener(async()=>{try{const e=await N(v.LOCAL_STORAGE_KEY),r=await N(v.PAGE_STORAGE_KEY)||[];e&&(await le(v.LOCAL_STORAGE_KEY),w.info("\u6E05\u7406\u6B8B\u7559\u7684\u5168\u5C40\u5B58\u50A8\u7981\u7528\u72B6\u6001")),r.length>0&&(await le(v.PAGE_STORAGE_KEY),w.info("\u6E05\u7406\u6B8B\u7559\u7684\u9875\u9762\u5B58\u50A8\u7981\u7528\u72B6\u6001"))}catch(e){w.error("\u6269\u5C55\u521D\u59CB\u5316\u5931\u8D25:",e)}}),X("requestPageContent",async e=>{var r;try{const t=await chrome.tabs.query({active:!0,currentWindow:!0});return(r=t[0])!=null&&r.id?await ue("requestPageContent",{config:{extractStrategy:"smart",maxLength:1e4},forceRefresh:!0},{tabId:t[0].id}):H("NO_ACTIVE_TAB")}catch(t){return w.error("\u8F6C\u53D1\u6D88\u606F\u5931\u8D25:",t),H(String(t))}}),X("checkFloatingWindowState",async e=>{var r,t;try{const n=await chrome.tabs.query({active:!0,currentWindow:!0});let s=await N(v.LOCAL_STORAGE_KEY)||!1;const i=(((r=e==null?void 0:e.data)==null?void 0:r.url)||((t=n[0])==null?void 0:t.url)||"").split("?")[0];if(w.info("\u68C0\u67E5\u60AC\u6D6E\u7A97\u72B6\u6001,\u63A5\u6536\u6D88\u606F:",{isDisabled:s,currentUrl:i,pageDisabledArr:await N(v.PAGE_STORAGE_KEY)}),s)return I("\u68C0\u67E5\u7981\u7528\u72B6\u6001\u6210\u529F",{isDisabled:s,localDisabled:s,pageDisabled:!1});if(!s&&i){const l=(await N(v.PAGE_STORAGE_KEY)||[]).includes(i);return s=l,I("\u68C0\u67E5\u7981\u7528\u72B6\u6001\u6210\u529F",{isDisabled:s,localDisabled:!1,pageDisabled:l})}return I("\u68C0\u67E5\u7981\u7528\u72B6\u6001\u6210\u529F",{isDisabled:!1,localDisabled:!1,pageDisabled:!1})}catch(n){return w.error("\u68C0\u67E5\u7981\u7528\u72B6\u6001\u5931\u8D25:",n),I("\u68C0\u67E5\u7981\u7528\u72B6\u6001\u5931\u8D25\uFF0C\u9ED8\u8BA4\u542F\u7528",{isDisabled:!1,localDisabled:!1,pageDisabled:!1})}}),X("setFloatingWindowState",async e=>{var s,o,i;w.info("\u8BBE\u7F6E\u60AC\u6D6E\u7A97\u72B6\u6001,\u63A5\u6536\u6D88\u606F:",e==null?void 0:e.data);const r=e.data.scope,t=e.data.disabled,n=(s=e==null?void 0:e.data)==null?void 0:s.url;try{const a=await chrome.tabs.query({active:!0,currentWindow:!0});if(r=="local")t||(await le(v.LOCAL_STORAGE_KEY),await le(v.PAGE_STORAGE_KEY)),await Oe(v.LOCAL_STORAGE_KEY,t);else{let u=await N(v.PAGE_STORAGE_KEY)||[];const g=(n||((o=a[0])==null?void 0:o.url)||"").split("?")[0];w.info("\u8BBE\u7F6E\u9875\u9762\u7981\u7528,\u5F53\u524D URL:",g,"\u73B0\u6709\u6570\u7EC4:",u),t?(u.length>100&&u.pop(),u.includes(g)||u.unshift(g)):u.includes(g)&&u.splice(u.indexOf(g),1),await Oe(v.PAGE_STORAGE_KEY,u)}let l=(i=a[0])==null?void 0:i.id;try{if(n){const g=(await chrome.tabs.query({})).find(f=>(f.url||"").split("?")[0]===n.split("?")[0]);g!=null&&g.id&&(l=g.id)}}catch{w.warn("\u6839\u636E URL \u5339\u914D\u6807\u7B7E\u9875\u5931\u8D25\uFF0C\u56DE\u9000\u5230\u5F53\u524D\u6FC0\u6D3B\u6807\u7B7E\u9875")}return l&&(t?await ue("removeFloatingWindow",{},{tabId:l}):await ue("enableFloatingWindow",{},{tabId:l})),I(`\u8BBE\u7F6E${r}\u7981\u7528\u72B6\u6001\u6210\u529F`)}catch(a){return w.error(`\u8BBE\u7F6E${r}\u7981\u7528\u72B6\u6001\u5931\u8D25:`,a),H(String(a))}}),X("getUserInfo",async()=>{try{let e=await N(v.USER_INFO_KEY);return(!e||!e.userId)&&(e=await Xr()),I("\u83B7\u53D6\u7528\u6237\u4FE1\u606F\u6210\u529F",e)}catch(e){return w.error("\u83B7\u53D6\u7528\u6237\u4FE1\u606F\u5931\u8D25:",e),H(String(e))}}),X("setTheme",async e=>{var t;w.info("\u8BBE\u7F6E\u4E3B\u9898,\u63A5\u6536\u6D88\u606F:",e==null?void 0:e.data);const r=e.data.theme;try{const n=await chrome.tabs.query({active:!0,currentWindow:!0});if(!((t=n[0])!=null&&t.id))return w.warn("\u672A\u627E\u5230\u6D3B\u52A8\u6807\u7B7E\u9875\uFF0C\u4E3B\u9898\u8BBE\u7F6E\u5DF2\u4FDD\u5B58\u5230\u5B58\u50A8"),I(`\u8BBE\u7F6E\u4E3B\u9898\u6210\u529F:${r} (\u672A\u540C\u6B65\u5230\u6807\u7B7E\u9875)`);try{await ue("setTheme",{theme:r},{tabId:n[0].id}),w.info("\u4E3B\u9898\u5DF2\u540C\u6B65\u5230\u6807\u7B7E\u9875:",n[0].id)}catch(s){w.warn("\u65E0\u6CD5\u540C\u6B65\u4E3B\u9898\u5230\u6807\u7B7E\u9875 (\u53EF\u80FD\u672A\u6CE8\u5165 content script):",s)}return I(`\u8BBE\u7F6E\u4E3B\u9898\u6210\u529F:${r}`)}catch(n){return w.error("\u8BBE\u7F6E\u4E3B\u9898\u5931\u8D25:",n),H(String(n))}})}});function ot(){}(rr=(er=globalThis.browser)==null?void 0:er.runtime)!=null&&rr.id?globalThis.browser:globalThis.chrome;function ce(e,...r){}const rt={debug:(...e)=>ce(console.debug,...e),log:(...e)=>ce(console.log,...e),warn:(...e)=>ce(console.warn,...e),error:(...e)=>ce(console.error,...e)};let Re;try{Re=et.main(),Re instanceof Promise&&console.warn("The background's main() function return a promise, but it must be synchronous")}catch(e){throw rt.error("The background crashed on startup!"),e}return Re}();
background;
